<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta name="generator" content="Hugo 0.62.0" />
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">




<meta itemprop="name" content="SQL语言">
<meta itemprop="description" content="SQL语言 3.4 关系数据库语言SQL’92 3.4.1 SQL概貌 SQL的基本概念与使用方式：表（基表/虚表），行，列 3.4.2 SQL数据定义功能 3.4.3 SQL数据操纵功">
<meta itemprop="datePublished" content="2020-01-01T00:13:14&#43;08:00" />
<meta itemprop="dateModified" content="2020-01-01T00:13:14&#43;08:00" />
<meta itemprop="wordCount" content="3343">



<meta itemprop="keywords" content="" />
<meta property="og:title" content="SQL语言" />
<meta property="og:description" content="SQL语言 3.4 关系数据库语言SQL’92 3.4.1 SQL概貌 SQL的基本概念与使用方式：表（基表/虚表），行，列 3.4.2 SQL数据定义功能 3.4.3 SQL数据操纵功" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://shelah-kuang.github.io/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%AE%BA/sql/" />
<meta property="article:published_time" content="2020-01-01T00:13:14+08:00" />
<meta property="article:modified_time" content="2020-01-01T00:13:14+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SQL语言"/>
<meta name="twitter:description" content="SQL语言 3.4 关系数据库语言SQL’92 3.4.1 SQL概貌 SQL的基本概念与使用方式：表（基表/虚表），行，列 3.4.2 SQL数据定义功能 3.4.3 SQL数据操纵功"/>

<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
<title>SQL语言</title>
<link rel="stylesheet" href="/css/bootstrap.materia.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
<link rel="stylesheet" href="//at.alicdn.com/t/font_1604402_k1uzbu1kus.css">

<link rel="stylesheet" href="/sass/main.min.b85c780ce29d94800879b7f7d03bdbd1ed6e538ce8a520b9c374570f8c6ce49a.min.8e2aeef93a541530729538cb32ede52cfe40cf74307f450f1a6e5a4acd47ebb0.css" integity="sha256-jiru&#43;TpUFTBylTjLMu3lLP5Az3Qwf0UPGm5aSs1H67A=">
</head>

<body style="overflow-x: unset;">
	<div class="container-fluid">
		<div class="row d-print-block">
			<div class="col-12 col-md-3 col-lg-2 bd-sidebar d-print-none">
				<div class="d-flex mt-3 border-bottom">
        <span class="navbar-brand w-100" style="display: grid;">
            <small>
                <a href="/" class="text-black-50">
                    <i class="iconfont icon-back-arrow-"></i>
                </a>
                TristonK's
            </small>
            <a class="text-dark" href="/notes/">
                Documents
            </a>
        </span>
        <button class="btn btn-link text-dark d-md-none p-0 ml-3" type="button" data-toggle="collapse"
            data-target="#bd-docs-nav" aria-controls="bd-docs-nav" aria-expanded="true"
            aria-label="Toggle docs navigation">
            <i class="fad fa-bars"></i>
        </button>
    </div>
				<nav id="bd-docs-nav" class="collapse bd-links">
    
    
    
    <div class="bd-toc-item">
        <a class="bd-toc-link" href="/notes/%E5%BE%AE%E7%94%B5%E5%AD%90%E4%B8%8E%E7%94%B5%E8%B7%AF/">
            
            
                
                    <span class="icontext">M</span>
                
            
            
            微电子与电路
        </a>
    </div>
    
    
    
    <div class="bd-toc-item">
        <a class="bd-toc-link" href="/notes/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0/">
            
                <i class="iconfont icon-construction rawicon"></i>
            
            强化学习
        </a>
    </div>
    
    
    
    <div class="bd-toc-item">
        <a class="bd-toc-link" href="/notes/%E7%A4%BE%E4%BC%9A%E5%AD%A6%E6%A6%82%E8%AE%BA/">
            
                <i class="iconfont icon-construction rawicon"></i>
            
            社会学概论
        </a>
    </div>
    
    
    
    <div class="bd-toc-item">
        <a class="bd-toc-link" href="/notes/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/">
            
                <i class="iconfont icon-construction rawicon"></i>
            
            组合数学
        </a>
    </div>
    
    
    
    <div class="bd-toc-item active bg-light">
        <a class="bd-toc-link" href="/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%AE%BA/">
            <i class="iconfont icon-back-arrow-reverse"></i>
            数据库概论
        </a>
        <ul class="nav bd-sidenav">
            
            
            <li>
                <a href="/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%AE%BA/introduction/">数据库系统概述</a>
            </li>
            
            
            
            <li>
                <a href="/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%AE%BA/data-model/">数据模型</a>
            </li>
            
            
            
            <li>
                <a href="/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%AE%BA/relational-database-system/">关系数据库系统</a>
            </li>
            
            
            
            <li class="active">
                <a href="/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%AE%BA/sql/">
                    <i class="fad fa-chevron-right mr-1"></i>
                    SQL语言
                </a>
            </li>
            
            
            
            <li>
                <a href="/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%AE%BA/security-and-integrity/">数据库安全性与完整性</a>
            </li>
            
            
            
            <li>
                <a href="/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%AE%BA/transaction/">事务管理、并发控制与故障恢复</a>
            </li>
            
            
            
            <li>
                <a href="/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%AE%BA/data-exchange/">游标管理与索引</a>
            </li>
            
            
            
            <li>
                <a href="/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%AE%BA/normal-form/">关系数据库规范化理论</a>
            </li>
            
            
            
            <li>
                <a href="/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%AE%BA/db-design/">数据库设计</a>
            </li>
            
            
            
            <li>
                <a href="/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%AE%BA/homework/">思考题与作业题</a>
            </li>
            
            
            
            <li>
                <a href="/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%AE%BA/sample-exam/">样卷整理</a>
            </li>
            
            
        </ul>
    </div>
    
    
    
    <div class="bd-toc-item">
        <a class="bd-toc-link" href="/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">
            
                <i class="iconfont icon-construction rawicon"></i>
            
            计算机网络
        </a>
    </div>
    
    
</nav>
			</div>
			<div class="col-12 col-md-9 col-lg-10 d-print-block">
				<div class="row d-print-block">
					<main class="col-12 col-md-10 col-lg-9 py-md-3 pl-md-5 bd-content d-print-block" role="main">
						<div id="title" class="my-4 border-bottom">
							<span>数据库概论</span>
							<h2>SQL语言</h2>
							<footer>
								<span>
									<i class="fad fa-calendar-alt mr-2"></i>
									2020-01-01 00:13 CST
								</span> <br />
								<span>
									<i class="fad fa-calendar-edit mr-2"></i>
									2020-01-01 00:13 CST
								</span> <br />
								<span>
									<i class="fad fa-copyright mr-2"></i>
									CC BY-NC 4.0
									<a class="float-right" href="#" onclick="window.print()">
											打印本页
									</a>
								</span>
							</footer>
						</div>
						<div id="content" class="hl-h2">
							<h1 id="sql">SQL语言<a href="#sql" class="anchor" aria-hidden="true"><i class="iconfont icon-link"></i></a></h1>
<blockquote>
<p>3.4 关系数据库语言SQL’92</p>
<p>3.4.1 SQL概貌</p>
<ul>
<li>SQL的基本概念与使用方式：表（基表/虚表），行，列</li>
</ul>
<p>3.4.2 SQL数据定义功能</p>
<p>3.4.3 SQL数据操纵功能</p>
<ul>
<li>SQL语言与关系代数的关系</li>
<li>映像语句（select statement）的结构</li>
<li>select/from/where/group by/having/order by</li>
<li>两个必须的子句: select/from</li>
<li>having子句的前面必须有group by子句</li>
<li>基本查询功能：distinct谓词；LIKE，IS NULL谓词；多表联接查询；表的自联接查询；</li>
<li>嵌套查询：IN，SOME/ANY/ALL，EXISTS等谓词；相关子查询与独立子查询；</li>
<li>子查询的合并：UNION/INTERSECT/EXCEPT/ALL运算</li>
<li>UNION / INTERSECT / EXCEPT</li>
<li>UNION ALL / INTERSECT ALL / EXCEPT ALL</li>
<li>统计查询（GROUP BY和HAVING）：统计与分组统计查询；空值与空集在统计函数中的处理方法</li>
<li>复杂数据查询：</li>
<li>统计查询</li>
<li>分组统计查询（… GROUP BY）</li>
<li>分组选择统计查询（… GROUP BY … HAVING …）</li>
<li>关系代数中的除法运算功能在SQL中的表示方法</li>
<li>多层嵌套的NOT EXISTS查询</li>
<li>在FROM子句中嵌入子查询</li>
<li>查询结果输出</li>
<li>结果元组去重：distinct</li>
<li>结果元组排序：order by</li>
</ul>
<p>3.4.4 SQL的更新功能</p>
<ul>
<li>元组删除</li>
<li>元组插入：常量元组的插入，带子查询的元组插入</li>
<li>元组修改</li>
</ul>
<p>3.4.5 视图</p>
<ul>
<li>视图概念，视图与基表的区别</li>
<li>视图的创建（CREATE VIEW）与删除（DROP VIEW）</li>
<li>视图的嵌套定义</li>
<li>视图删除中的连锁反应</li>
<li>可更新视图的判断准则</li>
<li>视图的作用</li>
</ul>
</blockquote>
<h2 id="sql-1">SQL概貌<a href="#sql-1" class="anchor" aria-hidden="true"><i class="iconfont icon-link"></i></a></h2>
<p>关系模型和SQL对应：</p>
<ul>
<li>关系：基表</li>
<li>关系子模式：视图(虚表)</li>
<li>属性：列</li>
<li>元组：行</li>
</ul>
<p>SQL不区分大小写</p>
<p>一条命令以分号作为结束</p>
<h2 id="sql-">SQL 数据定义功能<a href="#sql-" class="anchor" aria-hidden="true"><i class="iconfont icon-link"></i></a></h2>
<table>
<thead>
<tr>
<th align="left">符号</th>
<th align="right">数据类型</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">INT</td>
<td align="right">整数(2147483647)</td>
</tr>
<tr>
<td align="left">SMALLINT</td>
<td align="right">短整数(32767)</td>
</tr>
<tr>
<td align="left">DEC(m,n)</td>
<td align="right">十进制数(精度为m,小数位为n的小数)</td>
</tr>
<tr>
<td align="left">FLOAT</td>
<td align="right">浮点数</td>
</tr>
<tr>
<td align="left">CHAR(n)</td>
<td align="right">定长字符串</td>
</tr>
<tr>
<td align="left">VARCHAR(n)</td>
<td align="right">变长字符串</td>
</tr>
<tr>
<td align="left">BIT(n)</td>
<td align="right">定长位串</td>
</tr>
<tr>
<td align="left">BIT VARYING(n)</td>
<td align="right">变长位串</td>
</tr>
<tr>
<td align="left">DATE</td>
<td align="right">日期(年月日)</td>
</tr>
<tr>
<td align="left">TIME</td>
<td align="right">时间(小时、分、秒)</td>
</tr>
<tr>
<td align="left">TIMESTAMP</td>
<td align="right">时间戳(年月日小时分钟秒微秒)</td>
</tr>
</tbody>
</table>
<p>时间戳的格式：yyyy-mm-dd-hh.mm.ss.nnnnnn</p>
<p>创建表格：</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#080;font-weight:bold">CREATE</span>  <span style="color:#080;font-weight:bold">TABLE</span>  tablename (  
    colname  datatype  [ <span style="color:#080;font-weight:bold">NOT</span> <span style="color:#080;font-weight:bold">NULL</span> ]
    <span style="color:#f00;background-color:#faa">{</span> , colname  datatype  [ <span style="color:#080;font-weight:bold">NOT</span> <span style="color:#080;font-weight:bold">NULL</span> ] <span style="color:#f00;background-color:#faa">}</span>
) ;
</code></pre></div><p>对基表的属性进行增加/删除：</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#080;font-weight:bold">ALTER</span>  <span style="color:#080;font-weight:bold">TABLE</span>  <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">基</span><span style="color:#f00;background-color:#faa">表</span><span style="color:#f00;background-color:#faa">名</span><span style="color:#333">&gt;</span>  <span style="color:#080;font-weight:bold">ADD</span>  <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">列</span><span style="color:#f00;background-color:#faa">名</span><span style="color:#333">&gt;</span>  <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">数</span><span style="color:#f00;background-color:#faa">据</span><span style="color:#f00;background-color:#faa">类</span><span style="color:#f00;background-color:#faa">型</span><span style="color:#333">&gt;</span>;
<span style="color:#080;font-weight:bold">ALTER</span>  <span style="color:#080;font-weight:bold">TABLE</span>  <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">基</span><span style="color:#f00;background-color:#faa">表</span><span style="color:#f00;background-color:#faa">名</span><span style="color:#333">&gt;</span>  <span style="color:#080;font-weight:bold">DROP</span>  <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">列</span><span style="color:#f00;background-color:#faa">名</span><span style="color:#333">&gt;</span> ;
</code></pre></div><p>删除表格</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#080;font-weight:bold">DROP</span> <span style="color:#080;font-weight:bold">TABLE</span> <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">基</span><span style="color:#f00;background-color:#faa">表</span><span style="color:#f00;background-color:#faa">名</span><span style="color:#333">&gt;</span>;
</code></pre></div><h2 id="sql-2">SQL数据操纵功能<a href="#sql-2" class="anchor" aria-hidden="true"><i class="iconfont icon-link"></i></a></h2>
<p>映像语句（select statement）的结构：</p>
<ul>
<li>目标子句</li>
<li>范围子句</li>
<li>条件子句</li>
<li>分组子句</li>
<li>分组查询语句</li>
<li>排序输出语句</li>
</ul>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#080;font-weight:bold">SELECT</span>  <span style="color:#333">*</span> <span style="color:#333">|</span> colname <span style="color:#f00;background-color:#faa">{</span> , colname ... <span style="color:#f00;background-color:#faa">}</span>
<span style="color:#080;font-weight:bold">FROM</span>  tablename <span style="color:#f00;background-color:#faa">{</span> , tablename ... <span style="color:#f00;background-color:#faa">}</span>
[ <span style="color:#080;font-weight:bold">WHERE</span>  search_condition ]
[ <span style="color:#080;font-weight:bold">GROUP</span> <span style="color:#080;font-weight:bold">BY</span>  colname <span style="color:#f00;background-color:#faa">{</span> , colname ... <span style="color:#f00;background-color:#faa">}</span>
[ <span style="color:#080;font-weight:bold">HAVING</span>  group_condition ] ]
[ <span style="color:#080;font-weight:bold">ORDER</span> <span style="color:#080;font-weight:bold">BY</span>  colname [ <span style="color:#080;font-weight:bold">ASC</span> <span style="color:#333">|</span> <span style="color:#080;font-weight:bold">DESC</span> ]
 <span style="color:#f00;background-color:#faa">{</span> , colname [ <span style="color:#080;font-weight:bold">ASC</span> <span style="color:#333">|</span> <span style="color:#080;font-weight:bold">DESC</span> ] ... <span style="color:#f00;background-color:#faa">}</span> ];
</code></pre></div><p><strong>having子句的前面必须有group by子句</strong></p>
<p>目标子句可以用'表名.属性名'来表明是哪一个表中的属性</p>
<p>可以用AS对目标子句的结果重命名</p>
<p>可以用<strong>distinct</strong>来消除结果中的重复元组</p>
<p>可以在FROM子句中对一个关系重命名：<code>&lt;name&gt; &lt;newname&gt;</code></p>
<p>FROM子句中的部分是进行笛卡尔乘积进行合并</p>
<p><strong>BETWEEN..AND..</strong> 谓词：包括了两端（对应的有<strong>NOT BETWEEN AND</strong>）</p>
<h4 id="like">LIKE谓词：<a href="#like" class="anchor" aria-hidden="true"><i class="iconfont icon-link"></i></a></h4>
<p><code>column [NOT] LIKE val1 [ ESCAPE val2 ]</code></p>
<p>模版（pattern）：val1</p>
<ul>
<li>下划线（_）：可以匹配任意一个字符</li>
<li>百分号（%）：可以匹配任意一个字符串（包括长度为0的空字符串）</li>
<li>其它字符：只能匹配其自身</li>
</ul>
<p>例如以A开头的学生姓名：<code>WHERE sn LIKE 'A%'</code></p>
<p>转义指示字符：val2</p>
<ul>
<li>紧跟在转义指示字符val2之后的‘_’或‘%’（包括转义字符自身）不再是通配符，而是其自身</li>
</ul>
<p>例如课程名中带有_ 的：<code>WHERE cn LIKE '%A_%' ESCAPE 'A'</code></p>
<p><strong>IS NULL</strong> 与 <strong>IS NOT NULL</strong>；</p>
<p>在查询语句中可以使用<strong>NOT</strong>、<strong>AND</strong>、<strong>OR</strong>构造复杂的逻辑式</p>
<p><strong>嵌套查询</strong>：</p>
<ul>
<li>[NOT] IN ()</li>
<li>$\theta$ SOME/ANY/ALL ()</li>
<li>[NOT] EXISTS ()</li>
</ul>
<p>相关子查询:子查询中调用了外层查询，每次外层元组变量变化后都重新执行一次子查询，执行顺序从外到内</p>
<p>独立子查询: 子查询只执行一次，执行顺序从内到外</p>
<p>子查询之间的运算：</p>
<ul>
<li>并：UNION[ALL]</li>
<li>交：INTERSECT[ALL]</li>
<li>差：EXCEPT[ALL]</li>
</ul>
<p>统计查询：</p>
<ul>
<li>COUNT
<ul>
<li>COUNT(*):集合中的元组个数</li>
<li>COUNT(colname)：在colname属性上取值非空的元组个数</li>
<li>COUNT(distinct colname)：在colname属性上非空且互不相同的元组个数</li>
</ul>
</li>
<li>SUM</li>
<li>AVG</li>
<li>MAX</li>
<li>MIN</li>
</ul>
<p>统计查询一般运用在SELECT语句中，如果需要使用条件可以利用子查询，举例如下</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#f00;background-color:#faa">\</span><span style="color:#f00;background-color:#faa">\</span> <span style="color:#f00;background-color:#faa">查</span><span style="color:#f00;background-color:#faa">询</span><span style="color:#f00;background-color:#faa">有</span><span style="color:#f00;background-color:#faa">两</span><span style="color:#f00;background-color:#faa">个</span><span style="color:#f00;background-color:#faa">或</span><span style="color:#f00;background-color:#faa">两</span><span style="color:#f00;background-color:#faa">个</span><span style="color:#f00;background-color:#faa">以</span><span style="color:#f00;background-color:#faa">上</span><span style="color:#f00;background-color:#faa">的</span><span style="color:#f00;background-color:#faa">客</span><span style="color:#f00;background-color:#faa">户</span><span style="color:#f00;background-color:#faa">订</span><span style="color:#f00;background-color:#faa">购</span><span style="color:#f00;background-color:#faa">过</span><span style="color:#f00;background-color:#faa">的</span><span style="color:#f00;background-color:#faa">商</span><span style="color:#f00;background-color:#faa">品</span><span style="color:#f00;background-color:#faa">的</span><span style="color:#f00;background-color:#faa">编</span><span style="color:#f00;background-color:#faa">号</span><span style="color:#f00;background-color:#faa">（</span>pid<span style="color:#f00;background-color:#faa">）</span>
<span style="color:#080;font-weight:bold">SELECT</span> p.pid
<span style="color:#080;font-weight:bold">FROM</span>     products  p
<span style="color:#080;font-weight:bold">WHERE</span>  <span style="color:#00d;font-weight:bold">2</span> <span style="color:#333">&lt;</span><span style="color:#333">=</span> <span style="color:#080;font-weight:bold">ALL</span> (<span style="color:#080;font-weight:bold">SELECT</span> <span style="color:#080;font-weight:bold">count</span>(<span style="color:#080;font-weight:bold">distinct</span> cid)
                  <span style="color:#080;font-weight:bold">FROM</span>      orders  o
                 <span style="color:#080;font-weight:bold">WHERE</span>  o.pid <span style="color:#333">=</span> p.pid )
</code></pre></div><p><strong>不等于的表示</strong>：<code>&lt;&gt;</code>;</p>
<p>使用了GROUP BY 语句之后，SELECT语句对每个分组进行查询，每个分组返回一条结果语句</p>
<p>tip：在成绩类的判断中，常见的对于一个学生可以利用sno进行分组</p>
<p><strong>分组统计查询中，目标属性必须包括所有的分组属性</strong></p>
<p>在一些DBMS中，允许在FROM子句中嵌入子查询，举例如下：</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#f00;background-color:#faa">\</span><span style="color:#f00;background-color:#faa">\</span><span style="color:#f00;background-color:#faa">每</span><span style="color:#f00;background-color:#faa">个</span><span style="color:#f00;background-color:#faa">供</span><span style="color:#f00;background-color:#faa">应</span><span style="color:#f00;background-color:#faa">商</span><span style="color:#f00;background-color:#faa">单</span><span style="color:#f00;background-color:#faa">笔</span><span style="color:#f00;background-color:#faa">销</span><span style="color:#f00;background-color:#faa">售</span><span style="color:#f00;background-color:#faa">最</span><span style="color:#f00;background-color:#faa">高</span><span style="color:#f00;background-color:#faa">金</span><span style="color:#f00;background-color:#faa">额</span><span style="color:#f00;background-color:#faa">的</span><span style="color:#f00;background-color:#faa">平</span><span style="color:#f00;background-color:#faa">均</span><span style="color:#f00;background-color:#faa">值</span>
<span style="color:#080;font-weight:bold">SELECT</span>  <span style="color:#080;font-weight:bold">avg</span> ( t.x )
<span style="color:#080;font-weight:bold">FROM</span>     ( <span style="color:#080;font-weight:bold">select</span>  aid, <span style="color:#080;font-weight:bold">max</span>(dollars)  <span style="color:#080;font-weight:bold">as</span>  x
        <span style="color:#080;font-weight:bold">from</span>   orders
        <span style="color:#080;font-weight:bold">group</span> <span style="color:#080;font-weight:bold">by</span>  aid )   t  ;
</code></pre></div><p>关系代数中的除法运算功能在SQL中的表示方法</p>
<p>多层嵌套的NOT EXISTS查询</p>
<p>在FROM子句中嵌入子查询</p>
<p>查询结果输出</p>
<p>结果元组去重：distinct</p>
<p>结果元组排序：order by</p>
<p>映像语句的处理顺序:</p>
<ul>
<li>合并FROM子句中的表（笛卡儿乘积）</li>
<li>利用WHERE子句中的条件进行元组选择，抛弃不满足WHERE条件的那些元组</li>
<li>根据GROUP BY子句对保留下来的元组进行分组</li>
<li>利用HAVING子句中的条件对分组后的元组集合（group）进行选择，抛弃不满足HAVING条件的那些元  组集合</li>
<li>根据SELECT子句进行统计计算，生成结果关系中的元组</li>
<li>根据ORDER BY子句对查询结果进行排序</li>
</ul>
<h2 id="sql-3">SQL数据更新功能<a href="#sql-3" class="anchor" aria-hidden="true"><i class="iconfont icon-link"></i></a></h2>
<h3 id="heading">元组删除<a href="#heading" class="anchor" aria-hidden="true"><i class="iconfont icon-link"></i></a></h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#080;font-weight:bold">DELETE</span>  <span style="color:#080;font-weight:bold">FROM</span>  <span style="color:#080;font-weight:bold">table_name</span>
[ <span style="color:#080;font-weight:bold">WHERE</span>  search_condition ] ;
</code></pre></div><h3 id="heading-1">元组插入<a href="#heading-1" class="anchor" aria-hidden="true"><i class="iconfont icon-link"></i></a></h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#080;font-weight:bold">INSERT</span>
<span style="color:#080;font-weight:bold">INTO</span>  tabname [ ( colname <span style="color:#f00;background-color:#faa">{</span> , colname <span style="color:#f00;background-color:#faa">…</span> <span style="color:#f00;background-color:#faa">}</span> ) ]
<span style="color:#080;font-weight:bold">VALUES</span>  ( expr <span style="color:#333">|</span> <span style="color:#080;font-weight:bold">NULL</span> <span style="color:#f00;background-color:#faa">{</span> , expr <span style="color:#333">|</span> <span style="color:#080;font-weight:bold">NULL</span> <span style="color:#f00;background-color:#faa">…</span> <span style="color:#f00;background-color:#faa">}</span> ) <span style="color:#333">|</span> subquery;
</code></pre></div><p>可以插入常量元组（VALUES(&hellip;)），也可以将子查询结果插入(subquery)</p>
<h3 id="heading-2">元组修改<a href="#heading-2" class="anchor" aria-hidden="true"><i class="iconfont icon-link"></i></a></h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#080;font-weight:bold">UPDATE</span>  <span style="color:#080;font-weight:bold">table_name</span>
<span style="color:#080;font-weight:bold">SET</span>  colname <span style="color:#333">=</span> expr <span style="color:#333">|</span> <span style="color:#080;font-weight:bold">NULL</span> <span style="color:#333">|</span> subquery, ......
[ <span style="color:#080;font-weight:bold">WHERE</span>  search_condition ] ;
</code></pre></div><h2 id="heading-3">视图<a href="#heading-3" class="anchor" aria-hidden="true"><i class="iconfont icon-link"></i></a></h2>
<p>视图的定义：</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#080;font-weight:bold">CREATE</span>  <span style="color:#080;font-weight:bold">VIEW</span>  <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">视</span><span style="color:#f00;background-color:#faa">图</span><span style="color:#f00;background-color:#faa">名</span><span style="color:#333">&gt;</span>  [ ( <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">列</span><span style="color:#f00;background-color:#faa">名</span><span style="color:#333">&gt;</span> <span style="color:#f00;background-color:#faa">{</span> , <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">列</span><span style="color:#f00;background-color:#faa">名</span><span style="color:#333">&gt;</span> <span style="color:#f00;background-color:#faa">…</span> <span style="color:#f00;background-color:#faa">}</span> ) ]
<span style="color:#080;font-weight:bold">AS</span>  <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">映</span><span style="color:#f00;background-color:#faa">像</span><span style="color:#f00;background-color:#faa">语</span><span style="color:#f00;background-color:#faa">句</span><span style="color:#333">&gt;</span>   [ <span style="color:#080;font-weight:bold">WITH</span>  <span style="color:#080;font-weight:bold">CHECK</span>  <span style="color:#080;font-weight:bold">OPTION</span> ]
</code></pre></div><p>视图:由若干张表经过映像语句构筑成的表，又称导出表</p>
<p>视图与基表的区别：被称为视图的二维表本身（结构与数据）并不实际存在于数据库内，而仅仅保留了其构造信息（有关视图的定义信息）。因此视图又被称为‘虚表’（virtual table）。当用户执行视图上的访问操作时，数据库管理系统将根据视图的定义命令将用户对于视图的访问操作转换成相应基表上的访问操作</p>
<h3 id="-create-view">视图的创建 (CREATE VIEW)<a href="#-create-view" class="anchor" aria-hidden="true"><i class="iconfont icon-link"></i></a></h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#080;font-weight:bold">CREATE</span>  <span style="color:#080;font-weight:bold">VIEW</span>  <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">视</span><span style="color:#f00;background-color:#faa">图</span><span style="color:#f00;background-color:#faa">名</span><span style="color:#333">&gt;</span>  [ ( <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">列</span><span style="color:#f00;background-color:#faa">名</span><span style="color:#333">&gt;</span> <span style="color:#f00;background-color:#faa">{</span> , <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">列</span><span style="color:#f00;background-color:#faa">名</span><span style="color:#333">&gt;</span> <span style="color:#f00;background-color:#faa">…</span> <span style="color:#f00;background-color:#faa">}</span> ) ]
<span style="color:#080;font-weight:bold">AS</span>  <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">映</span><span style="color:#f00;background-color:#faa">像</span><span style="color:#f00;background-color:#faa">语</span><span style="color:#f00;background-color:#faa">句</span><span style="color:#333">&gt;</span>   [ <span style="color:#080;font-weight:bold">WITH</span>  <span style="color:#080;font-weight:bold">CHECK</span>  <span style="color:#080;font-weight:bold">OPTION</span> ]
</code></pre></div><p>如上创建一个以&lt;视图名&gt; 为表名的视图，对应的数据查询语句是&lt;映像语句&gt;。以&lt;映像语句&gt;作查询所得到的查询结果即是该视图中的元组。</p>
<p>如果没有给视图中的属性命名，则用&lt;映像语句&gt;的SELECT子句中的属性名作为视图属性的属性名。否则视图中的属性必需与&lt;映像语句&gt;的SELECT子句中的结果属性一一对应</p>
<p>WITH CHECK OPTION用于约束视图上的修改操作：如果允许在该视图上执行更新操作，则其更新后的结果元组仍然必需满足视图的定义条件。即通过该视图插入或修改后的新元组能够通过该视图上的查询操作查出来</p>
<p><strong>可以嵌套的创建视图</strong>（即映像语句中FROM一个已经存在的视图）</p>
<h3 id="drop-view">视图的删除（DROP VIEW）<a href="#drop-view" class="anchor" aria-hidden="true"><i class="iconfont icon-link"></i></a></h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#080;font-weight:bold">DROP</span> <span style="color:#080;font-weight:bold">VIEW</span> <span style="color:#333">&lt;</span><span style="color:#f00;background-color:#faa">视</span><span style="color:#f00;background-color:#faa">图</span><span style="color:#f00;background-color:#faa">名</span><span style="color:#333">&gt;</span>
</code></pre></div><p><strong>删除一个视图后，那些嵌套定义在该视图上的视图也会随之删除</strong></p>
<p>视图上可以进行查询操作(实际上是先改写成基表上的查询操作)</p>
<p>允许进行视图上的更新需要满足：视图的每一行必须对应基表的惟一一行，视图的每一列必须对应基表的惟一一列</p>
<ul>
<li>1、没有指定DISTINCT，即重复元组未从查询结果中消除；</li>
<li>2、定义查询的SELECT列表中的每个元素均为列名（而不是常量，表达式或聚合函数），且列名出现不能多于一次；</li>
<li>3、FROM子句只能指定一个表，即视图必须有一个源表且用户有请求该表的权限。如果源表本身就是一个视图，那么视图必须满足这些条件。因此，排除了基于连接、并（UNION）、交（INTERSECT）或差（EXCEPT）操作的所有视图</li>
<li>4、where子句不能包含任何引用了FROM子句的表的嵌套SELECT操作。</li>
<li>5、定义查询不能有GROUP BY或HAVING子句。</li>
</ul>
<p>视图的作用：提高了数据独立性，简化了用户观点，提供了自动的安全保护功能</p>

						</div>
					</main>
					<div class="d-none d-lg-block col-lg-3 bd-toc d-print-none">
						<div class="btn-group-vertical w-100 my-3">
    <a class="btn btn-outline-secondary text-dark w-100 p-2" href="https://github.com/shelah-kuang/shelah-kuang.github.io/commits/master" target="_blank">
        <i class="iconfont icon-LC_icon_list_line"></i><br />待更新列表
    </a>
    <a class="btn btn-outline-secondary text-dark w-100 p-2" href="mailto:kuangsl@foxmail.com"
        target="_blank">
        <i class="iconfont icon-discussion"></i><br />纠错与咨询
    </a>
</div>
						<nav id="TableOfContents">
  <ul>
    <li><a href="#sql-1">SQL概貌</a></li>
    <li><a href="#sql-">SQL 数据定义功能</a></li>
    <li><a href="#sql-2">SQL数据操纵功能</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#sql-3">SQL数据更新功能</a>
      <ul>
        <li><a href="#heading">元组删除</a></li>
        <li><a href="#heading-1">元组插入</a></li>
        <li><a href="#heading-2">元组修改</a></li>
      </ul>
    </li>
    <li><a href="#heading-3">视图</a>
      <ul>
        <li><a href="#-create-view">视图的创建 \(CREATE VIEW\)</a></li>
        <li><a href="#drop-view">视图的删除（DROP VIEW）</a></li>
      </ul>
    </li>
  </ul>
</nav>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.bundle.min.js"></script>
<script type="text/javascript" src="/js/leon.js"></script>
<script type="text/javascript" src="/js/TweenMax.min.js "></script>
<script type="text/javascript" src="/js/search.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.0/fuse.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
    integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
    
<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(
            document.body, {
                delimiters: [{
                        left: "$$",
                        right: "$$",
                        display: true
                    },
                    {
                        left: "\\[",
                        right: "\\]",
                        display: true
                    },
                    {
                        left: "$",
                        right: "$",
                        display: false
                    },
                    {
                        left: "\\(",
                        right: "\\)",
                        display: false
                    }
                ]
            }
        );
    });
</script>

<script type="text/javascript">
    $(document).on('click', 'a[href^="#"]', function (event) {
        event.preventDefault();

        $('html, body').animate({
            scrollTop: $($.attr(this, 'href')).offset().top
        }, 500);
    });
</script>


<script type="text/javascript">
    $(function () {
        $("[data-toggle='tooltip']").tooltip();
    });
</script>


</body>

</html>